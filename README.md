# RESTful Teacher Ranking
 
##	The Database

For the database model of the service 5 new tables were designed and implemented. Additionally, there is a sixth table which is created by and built-in Django for the users. There is table for Modules called Module which has two fields: code (Char Field with a limit 3 characters ) and name (Char Field and limit 50 characters). Code is the primary key. 
Secondly there is a table Professor also with two fields: id (Char Field with a limit of 3 characters) and name (Char Field and limit 50 characters). Id is it’s primary key. 
Another table is ModuleInstance which has three fields: module (a Foreign Key to the table Module), year (Integer Field) and semester (Integer Field) which is always either 1 or 2. 
An additional table is names TeachingAssignment with two fields: module_instance (Foreign Key to the table ModuleInstance) and the second field professor (Foreign Key to the table Professor), both of these are possible as in Django every table has a unique ID. 
Lastly there is a Rating table with 4 fields: user (Foreign key to Django’s built-in User Model), teaching_assignment (Foreign key to Teaching Assignment) thanks to Django unique table ID , rating (Integer Field) between 1-5 and created_at ( DataTimeField).

There is Many to One relationship from TeachingAssignment to ModuleInstance as there can be multiple Teaching Assignments for a single Module Instance. There is also Many to One relationship from TeachingAssignment to professor as there can be multiple Teaching Assignments for a single professor. Moreover, Module to ModuleInstance has a One to Many relationship as each Module Instance belongs to a single module. Finally to Many to One relationship from Rating to User as a user can create many ratings but it only can be created by one user and Many to One from Rating to TeachingAssignment due to the fact that a single TeachingAssignment can have multiple ratings.

Ultimately two unique together relationships have been implemented. First one is between user and TeachingAssignment as the user can only rate a specific TeachingAssignment once. The second one is between module_instance and professor due to the fact that a professor can only appear once per module_instance


## The API
For this API I created 7 API endpoints.
Firstly I created a Register endpoint which allows the user to create an account. With URL: https://ed20jpsv.pythonanywhere.com/api/register/ , it uses a POST Method since it has to send data to the server to create the account. It is JSON Request, with username, email and password and their corresponding details. Email is optional but is saved when given. However both username and password are mandatory. If it is successful it will return a status code 201 and the message “message: User registered successfully.”, If unsuccessful it will return a status code 400 and error message  “error: username already exists” if username is already taken.
Secondly, a Login endpoint was made with the purpose of allowing the user to log in with the details of the previous created account. With URL: https://ed20jpsv.pythonanywhere.com/api/login/ , it uses a POST Method since it has to send data to the server to check the credentials of the account. It is JSON Request, with username and password and their corresponding details, both of which are required. If it is successful it returns a status code 200 with the message: “message: Login successful.”. If it is not then it will prompt a status code 401 with error message “error: Invalid credentials.”.
Thirdly, I implemented a Logout to allow the user to disconnect from their account or even login into a new one. With URL: https://ed20jpsv.pythonanywhere.com/api/logout/ , it uses a POST Method as it best practice to use POST with a CSRF token for logout and in real life situations it could leave the user vulnerable. There is no request and the response data is always the same. A message “message: Logout successful.” It never sends an error message as it always clears the token and cookies even if there are none.
In succession, I designed a List endpoint which allows the user to view a list of all of the module instances and professor’s teaching them.  With URL: https://ed20jpsv.pythonanywhere.com/api/list/ . It uses a GET Method as nothing needs to be inputted and it is instead the user requesting data from the server. There is no request data. The status code received when it works is 200 and the response data will be the list in JSON. It should never have errors as in this project list is available even when not logged in.
Following that, I made a View endpoint which lets the user see the average ratings in all modules and module instances. With URL: https://ed20jpsv.pythonanywhere.com/api/view/ . It uses a GET Method since it does not require user input. There is no request data. The response data will be the list with modules and each professors average (in stars) in JSON. It will output status code of 200 and once again it should not have any errors since no credentials required.
Successively, I created Average endpoint that allows the user to see the average of a professor in a specific module. With URL(example): https://ed20jpsv.pythonanywhere.com/api/average/TT1/CD1/ ,  It uses a GET Method since it will provide the user with the requested information from the server. There is no request data for this case. The response data comes in JSON it will provide the user with the professor average in stars 1-5 and the module. It should output a 200 status code. In the case the professor id or the module id provided in the URL are not valid, does not exist, it will send status code 404 to represent the error.

Finally, a Rate endpoint was created which allows the to rate the professors in a certain module instance. The user must be logged in order to be able to rate. With URL: https://ed20jpsv.pythonanywhere.com/api/rate-professor/ , It uses a POST Method since it requires the user to provide data in order to rate, like, professor id, rating, module code, year and semester. The request data in JSON is all the listed before professor id, rating, module code, year and semester. And the data if successful will be a message saying “Rating created successfully” and the rating_id. The status code possible are if successful 201. However if invalid it can 400 if the data is invalid or the user has already rated that exact case. 403 if the user has not logged in yet and finally 404 if the professor or module do not exist.


##	The Client
The client was implemented in the most simplistic way possible. When the client program is opened the user can input any commands instantly without any prior steps required. Just need to follow Readme.txt . In the case of non-existent command the user will be prompted to type again a new one till they close or write a valid one. When a user types a correct command but one of the fields after are wrong they are prompted to type it again and with a suggestion of the correct syntax above. Whenever a request is valid the user receives HTTP Status confirmation and permits them to type the details required or visualise the information they want. However, when there is an error an HTTP error message is shown on the terminal following what issue/error was in order for you to use to retry and avoid having the same problem. Moreover in case there is other errors hard to account, such as Internet problems try and except was implemented and it will print an Error message instead of breaking. Another error possibility accounted for is when the user types more than required it will read as many words as fields needed for that command. The user does not have to type the link as of Pythonanywhere page as it previously handled in the Client Program in order to avoid syntax and complications when connecting to server.

##	Using the client
The client program works in any Python3 Terminal From the moment it opensthe user is allowed to type their inputs. The following list contains all the commands and how to use them (do not type “command:” ) : 
Command: register - This is will after ask for an username, email and password and if valid it will create a new user. If username and email details are new and now instance in the database with the same then it will successfully create a new account.
Command: login <url> - In this case the user should type "login https://ed20jpsv.pythonanywhere.com" as instructed in assignment instructions. After the user types login followed by the correct url it will be asked to type the username and password preferred. If there is an account with such details then it will successfully login
Command: logout - It will logout from current user and user can not any tasks that require them to be logged in. The user must be logged in for this 
Command: list - It will provide a list of the modules instances and the professors teaching them
Command: view - It will provide a list with rating of all professors
Command: average <professor_id> <module_code> - For example, "average JE1 CD1".This will provide the average rating of a professor in a specific module
Command: rate <professor_id> <module_code> <year> <semester> <rating> - For example,        "rate JE1 CD1 2017 1 4". In order to rate the user must be logged in, so log in before try to rate and this will add a new rating to the teacher in a module instance in the database. The rating must be between including 1-5 or it will not be accepted

